package org.codegen;

import org.codegen.ApiCodeGen.loader.Classloader;
import org.codegen.ApiCodeGen.templateHandler.Handlebar;
import org.codegen.JOOQ.PojosGen.EntityClassGen;
import org.codegen.SwaggerCodeGen.GenerateSpringBootProject;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.Set;

import static org.codegen.ApiCodeGen.loader.Classloader.readClassName;

public class Main {
    private static final Logger log = LoggerFactory.getLogger(Main.class);
    static Classloader cl=new Classloader();
    static Handlebar hl=new Handlebar();
    static EntityClassGen entityClassGen =new EntityClassGen();
    static GenerateSpringBootProject gs=new GenerateSpringBootProject();

    public static void main(String[] args) throws Exception {

        log.info("<------ CodeGen FrameWork Started ------>");

//       entityClassGen.EntityGenerator("src/main/resources/Script.sql","org.codegen.ApiCodeGen.entity","src/main/java");

        System.out.println("Start Time"+System.currentTimeMillis());
        entityClassGen.EntityGenerator("src/main/resources/Script.sql","org.codegen.ApiCodeGen.entity","src/main/java");
        System.out.println("End Time"+System.currentTimeMillis());
//        try
//        {
//            System.out.println("hi");
//            Thread.sleep(2982);
//            System.out.println("End");
//        }
//        catch(InterruptedException e)
//        {
//            System.out.println(e);
//        }


//        File file=new File("D:\\Intellj Projects\\SwaggerCodeGen\\src\\main\\java\\org\\codegen\\ApiCodeGen\\entity\\Tables.java");
//        File[] files = new File("D:\\Intellj Projects\\SwaggerCodeGen\\src\\main\\java\\org\\codegen\\ApiCodeGen\\entity").listFiles();
//        System.out.println(files.length);

            Set<String> s=readClassName();
            System.out.println(s);
            cl.loadClass(s);
            cl.convertIntoAPIJson();
            hl.SwaggerYaml();
            gs.generateProject("src/main/resources/SwaggerYaml.yml",
                    "spring",
                    "io.codejournal.maven.swagger2java.api",
                    "io.codejournal.maven.swagger2java.model",
                    "io.codejournal.maven.swagger2java.handler",
                    "src/main/java/org/Autogenerated");



    }
}